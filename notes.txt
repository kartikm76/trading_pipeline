Next Steps for Implementation
find . \( -path "./venv" -o -name "dist" -o -name ".git" \) -prune \
-o -type f \( -name "*.py" -o -name "*.sh" -o -name "*.yaml" -o -name "requirements.txt" \) \
-exec echo "--- FILE: {} ---" \; -exec cat {} \; > codebase_snapshot.txt

# add a new library
uv add "polars[fsspec,pyarrow]"

# Local Bootstrap
uv run python src/main.py --bootstrap
uv run python tests/inspect_tables.py

# Hybrid Test
ENV=hybrid uv run python tests/test_spark.py

# Production Bootstrap
# Steps before each run:
1. # Move everything back to landing
aws s3 mv s3://trading-pipeline/data/raw/staging/ s3://trading-pipeline/data/raw/landing/ --recursive
aws s3 mv s3://trading-pipeline/data/raw/processed/ s3://trading-pipeline/data/raw/landing/ --recursive

2. Drop Tables:
aws glue delete-table --database-name "trading_db" --name "strategy_signals"
aws glue delete-table --database-name "trading_db" --name "bronze_options_chain"
aws glue delete-table --database-name "trading_db" --name "enriched_options_silver"

3. Clear the warehouse physical files
aws s3 rm s3://trading-pipeline/iceberg-warehouse/ --recursive

4. Run:
./batch_control.sh prod


5. Strategy Run -- To Be Continued
(trading-pipeline) /Users/kartikmakker/Kartik_Workspace/trading_pipeline/infrastructure $ ./strategy_run.sh
üè† Project Root identified as: /Users/kartikmakker/Kartik_Workspace/trading_pipeline
üì¶ Packaging project...
‚¨ÜÔ∏è Syncing artifacts to s3://trading-pipeline/artifacts/ ...
upload: ../dist/src.zip to s3://trading-pipeline/artifacts/src.zip
upload: ../config.yaml to s3://trading-pipeline/artifacts/config.yaml
upload: ../src/main.py to s3://trading-pipeline/artifacts/main.py
üöÄ Triggering EMR Strategy Orchestration for App: 00g35nv23d1lkf09
{
    "applicationId": "00g35nv23d1lkf09",
    "jobRunId": "00g3ap5hcjhoc00b",
    "arn": "arn:aws:emr-serverless:us-east-1:949934295366:/applications/00g35nv23d1lkf09/jobruns/00g3ap5hcjhoc00b"
}

colima start --arch aarch64 --vm-type=vz --vz-rosetta
docker buildx build   --platform linux/amd64,linux/arm64   -t 949934295366.dkr.ecr.us-east-1.amazonaws.com/trading-pipeline:latest   --push .